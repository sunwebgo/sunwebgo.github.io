

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/hexo/favicon.png">
  <link rel="icon" href="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/hexo/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Xu huaiang">
  <meta name="keywords" content="">
  
    <meta name="description" content="1.背景引入在实际开发中，我们经常要一边开发一边测试，当然这里说的测试并不是程序员对自己代码的单元测试，而是同组程序员将代码提交后，由测试人员测试；或者前后端分离后，经常会修改接口，然后重新部署；这些情况都会涉及到频繁的打包部署； 　　手动打包常规步骤： 　　1.提交代码 　　2.问一下同组小伙伴有没有要提交的代码 　　3.拉取代码并打包（war包，或者jar包） 　　4.上传到Linux服务器">
<meta property="og:type" content="article">
<meta property="og:title" content="Jenkins">
<meta property="og:url" content="https://xhablog.online/2022/09/05/Jenkins/index.html">
<meta property="og:site_name" content="xhang′s blog">
<meta property="og:description" content="1.背景引入在实际开发中，我们经常要一边开发一边测试，当然这里说的测试并不是程序员对自己代码的单元测试，而是同组程序员将代码提交后，由测试人员测试；或者前后端分离后，经常会修改接口，然后重新部署；这些情况都会涉及到频繁的打包部署； 　　手动打包常规步骤： 　　1.提交代码 　　2.问一下同组小伙伴有没有要提交的代码 　　3.拉取代码并打包（war包，或者jar包） 　　4.上传到Linux服务器">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221011092253260.png">
<meta property="article:published_time" content="2022-09-05T07:00:00.000Z">
<meta property="article:modified_time" content="2023-08-25T16:55:30.950Z">
<meta property="article:author" content="Xu huaiang">
<meta property="article:tag" content="Jenkins">
<meta property="article:tag" content="CI&#x2F;CD">
<meta property="article:tag" content="自动化部署">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221011092253260.png">
  
  
  
  <title>Jenkins - xhang′s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/macpanel.css">
<link rel="stylesheet" href="/css/iconfont.css">
<link rel="stylesheet" href="/css/indeximg-hover.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"xhablog.online","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"giycfQfOF4KRyAqEJy6tocBG-gzGzoHsz","app_key":"eFPJSGrHpiDV2uq6UTxse15b","server_url":"https://giycfqfo.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>xhang′s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-zhuye"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-guidang1"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-fenlei"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-biaoqian"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/messageboard/">
                <i class="iconfont icon-liuyanban-05"></i>
                <span>留言板</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-youqinglianjie"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-guanyuwomen"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/hexo/index.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Jenkins"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        Xu huaiang
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-09-05 15:00" pubdate>
          2022年9月5日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          11k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          90 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Jenkins</h1>
            
            
              <div class="markdown-body">
                
                <p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221011092253260.png" srcset="/img/loading.gif" lazyload alt="image-20221011092253260"></p>
<h1 id="1-背景引入"><a href="#1-背景引入" class="headerlink" title="1.背景引入"></a>1.背景引入</h1><p>在实际开发中，我们经常要一边开发一边测试，当然这里说的测试并不是程序员对自己代码的单元测试，而是同组程序员将代码提交后，由测试人员测试；或者前后端分离后，经常会修改接口，然后重新部署；这些情况都会涉及到频繁的打包部署；</p>
<p>　　手动打包常规步骤：</p>
<p>　　1.提交代码</p>
<p>　　2.问一下同组小伙伴有没有要提交的代码</p>
<p>　　3.拉取代码并打包（war包，或者jar包）</p>
<p>　　4.上传到Linux服务器</p>
<p>　　5.查看当前程序是否在运行</p>
<p>　　6.关闭当前程序</p>
<p>　　7.启动新的jar包</p>
<p>　　8.观察日志看是否启动成功</p>
<p>　　9.如果有同事说，自己还有代码没有提交……再次重复1到8的步骤！</p>
<p>　　那么，有一种工具能够实现，将代码提交到git后就自动打包部署勒，答案是肯定的：Jenkins</p>
<h1 id="2-Jenkins简介"><a href="#2-Jenkins简介" class="headerlink" title="2.Jenkins简介"></a>2.Jenkins简介</h1><p>Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，&#x3D;&#x3D;用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件项目可以进行持续集成。&#x3D;&#x3D;</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221011094103256.png" srcset="/img/loading.gif" lazyload alt="image-20221011094103256"></p>
<p>在这里我们使用3台服务器分别搭建<code>私服库GitLab、Jenkins+Maven、测试服务器（运行jar包）</code></p>
<h1 id="3-GitLab环境搭建"><a href="#3-GitLab环境搭建" class="headerlink" title="3.GitLab环境搭建"></a>3.GitLab环境搭建</h1><h2 id="3-1SSH下安装GitLab"><a href="#3-1SSH下安装GitLab" class="headerlink" title="3.1SSH下安装GitLab"></a>3.1SSH下安装GitLab</h2><p><font color='red'>由于GitLab所需的内存比较大，所以建议虚拟机内存要在4G以上。</font></p>
<p>GItLab安装手册：<a target="_blank" rel="noopener" href="https://gitlab.cn/install/">GitLab最新版下载安装_GitLab中文免费版-极狐GitLab中文官方网站</a></p>
<ol>
<li><strong>安装依赖</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">sudo yum install -y curl policycoreutils-python openssh-server perl
sudo systemctl enable sshd
sudo systemctl start sshd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<ol start="2">
<li><strong>配置镜像</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">curl -fsSL https://packages.gitlab.cn/repository/raw/scripts/setup.sh | /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="3">
<li><strong>安装</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">sudo EXTERNAL_URL</span><span class="token punctuation">=</span><span class="token value attr-value">"http://虚拟机ip" yum install -y gitlab-jh</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>安装成功</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221011220621433.png" srcset="/img/loading.gif" lazyload alt="image-20221011220621433"></p>
<ol start="4">
<li><strong>GitLab的常用命令</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">gitlab-ctl start                  # 启动所有 gitlab 组件；
gitlab-ctl stop                   # 停止所有 gitlab 组件；
gitlab-ctl restart                # 重启所有 gitlab 组件；
gitlab-ctl status                 # 查看服务状态；
gitlab-ctl reconfigure            # 启动服务；
vi /etc/gitlab/gitlab.rb         # 修改默认的配置文件；
gitlab-ctl tail                   # 查看日志；<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ol start="5">
<li><strong>启动GitLab</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">gitlab-ctl start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="6">
<li><strong>进入登录界面，首次用户默认是root，进入目录下查看密码</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">/etc/gitlab/initial_root_password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221011220836647.png" srcset="/img/loading.gif" lazyload alt="image-20221011220836647"></p>
<ol start="7">
<li><strong>开放80端口</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">开放80端口
<span class="token key attr-name">firewall-cmd --zone</span><span class="token punctuation">=</span><span class="token value attr-value">public --add-port=80/tcp --permanent</span>
重新载入
firewall-cmd --reload
查看
<span class="token key attr-name">firewall-cmd --zone</span><span class="token punctuation">=</span><span class="token value attr-value">public --query-port=80/tcp</span>
删除
<span class="token key attr-name">firewall-cmd --zone</span><span class="token punctuation">=</span><span class="token value attr-value">public --remove-port=80/tcp --permanent</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>



<ol start="7">
<li><strong>登录GitLab</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221011221608038.png" srcset="/img/loading.gif" lazyload alt="image-20221011221608038"></p>
<h2 id="3-2创建虚拟机，Docker下安装GitLab"><a href="#3-2创建虚拟机，Docker下安装GitLab" class="headerlink" title="3.2创建虚拟机，Docker下安装GitLab"></a>3.2创建虚拟机，Docker下安装GitLab</h2><ol>
<li><strong>配置一个新的环境变量 <code>$GITLAB_HOME</code>，指向配置、日志和数据文件所在的目录。</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">export GITLAB_HOME</span><span class="token punctuation">=</span><span class="token value attr-value">/srv/gitlab</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="3">
<li><strong>运行镜像</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">sudo docker run --detach \
  --hostname 192.168.26.138 \
  --publish 80:80\
  --name gitlab \
  --restart always \
  --volume $GITLAB_HOME/config:/etc/gitlab \
  --volume $GITLAB_HOME/logs:/var/log/gitlab \
  --volume $GITLAB_HOME/data:/var/opt/gitlab \
  --shm-size 256m \
  registry.gitlab.cn/omnibus/gitlab-jh:latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p>这一步出错就重启docker服务</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">systemctl restart docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="4">
<li><p><strong>查看gitlab镜像和创建一个容器实例</strong></p>
</li>
<li><p><strong>启动gitlab</strong></p>
</li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">docker start 容器ID <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="6">
<li><strong>输入ip和相应的端口号访问gitlab</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012121030062.png" srcset="/img/loading.gif" lazyload alt="image-20221012121030062"></p>
<ol start="7">
<li><strong>输入用户名root和密码登录GitLab，密码在以下目录查看</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">docker exec -it gitlab grep 'Password:' /etc/gitlab/initial_root_password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>



<h1 id="4-Jenkins安装"><a href="#4-Jenkins安装" class="headerlink" title="4.Jenkins安装"></a>4.Jenkins安装</h1><h2 id="4-1Jenkins官网"><a href="#4-1Jenkins官网" class="headerlink" title="4.1Jenkins官网"></a>4.1Jenkins官网</h2><p>Jenkins中文网<a target="_blank" rel="noopener" href="https://www.jenkins.io/zh/">Jenkins</a></p>
<h2 id="4-2安装Jenkins的环境需求"><a href="#4-2安装Jenkins的环境需求" class="headerlink" title="4.2安装Jenkins的环境需求"></a>4.2安装Jenkins的环境需求</h2><ul>
<li>机器要求：<ul>
<li>256 MB 内存，建议大于 512 MB</li>
<li>10 GB 的硬盘空间（用于 Jenkins 和 Docker 镜像）</li>
</ul>
</li>
<li>需要安装以下软件：<ul>
<li>&#x3D;&#x3D;Java 11( JRE 或者 JDK 都可以)&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;Docker&#x3D;&#x3D;</li>
</ul>
</li>
</ul>
<h2 id="4-3安装JDK11"><a href="#4-3安装JDK11" class="headerlink" title="4.3安装JDK11"></a>4.3安装JDK11</h2><ol>
<li><strong>查找Centos自带的Openjdk</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">rpm -qa | grep java<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="2">
<li><strong>删除自带的jdk文件</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">rpm -e --nodeps java...<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="3">
<li><p><strong>下载jdk11安装包，并传输到指定目录</strong></p>
</li>
<li><p><strong>解压至自定义目录（一般是 &#x2F;usr&#x2F;local）,再删除安装包</strong></p>
</li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">tar -xzvf jdk-8u291-linux-x64.tar.gz -C /usr/local/
rm -rf jdk-11.0.17_linux-x64_bin.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<ol start="5">
<li><strong>进入&#x2F;etc&#x2F;profile文件，编辑内容</strong></li>
</ol>
<p>​			配置环境变量。在 profile 文件中添加四个变量。</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">export JAVA_HOME</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/jdk-11.0.17</span>
<span class="token key attr-name">export JRE_HOME</span><span class="token punctuation">=</span><span class="token value attr-value">$JAVA_HOME/jre</span>
<span class="token key attr-name">export CLASSPATH</span><span class="token punctuation">=</span><span class="token value attr-value">.:$JAVA_HOME/lib:$JRE_HOME/lib</span>
<span class="token key attr-name">export PATH</span><span class="token punctuation">=</span><span class="token value attr-value">/bin:/usr/bin:$PATH:$JAVA_HOME/bin:$PATH</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ol start="6">
<li><strong>退出文件，使设置生效</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="7">
<li><strong>查看jdk版本</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">java -version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028215112717.png" srcset="/img/loading.gif" lazyload alt="image-20221028215112717"></p>
<h2 id="4-4安装Maven"><a href="#4-4安装Maven" class="headerlink" title="4.4安装Maven"></a>4.4安装Maven</h2><p><a target="_blank" rel="noopener" href="https://maven.apache.org/">Maven – Welcome to Apache Maven</a></p>
<ol>
<li><strong>在官网下载最新版的maven安装包</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012201535007.png" srcset="/img/loading.gif" lazyload alt="image-20221012201535007"></p>
<ol start="2">
<li><p><strong>解压安装包</strong></p>
</li>
<li><p><strong>将解压后的文件放到指定目录下<code>/usr/local/maven</code></strong></p>
</li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">mv apache-maven-3.8.6 /usr/local/maven<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="4">
<li><strong>配置阿里云镜像</strong></li>
</ol>
<p>​			找到settings.xml文件</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">vim /usr/local/maven/conf/settings.xml<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>



<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012211956303.png" srcset="/img/loading.gif" lazyload alt="image-20221012211956303"></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">&lt;mirror>  
 &lt;id>alimaven&lt;/id>  
 &lt;name>aliyun maven&lt;/name>  
 &lt;url>http://maven.aliyun.com/nexus/content/groups/public/&lt;/url>
 &lt;mirrorOf>central&lt;/mirrorOf>          
&lt;/mirror><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012212539001.png" srcset="/img/loading.gif" lazyload alt="image-20221012212539001"></p>
<ol start="5">
<li><strong>查看Maven版本</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">/usr/local/maven/bin/mvn -v<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028220857654.png" srcset="/img/loading.gif" lazyload alt="image-20221028220857654"></p>
<h2 id="4-6安装Git"><a href="#4-6安装Git" class="headerlink" title="4.6安装Git"></a>4.6安装Git</h2><ol>
<li><strong>安装所需的环境</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">yum -y install libcurl-devel expat-devel curl-devel  gettext-devel openssl-devel zlib-devel
yum -y install  gcc perl-ExtUtils-MakeMaker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<ol start="2">
<li><strong>进入到&#x2F;usr&#x2F;lcoal的目录下，新建git目录</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">cd   /usr/local  			  #进入到/usr/lcoal的目录下
mkdir git        			  #新建git目录<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<ol start="3">
<li><strong>拉取git安装包</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">wget --no-check-certificate https://mirrors.edge.kernel.org/pub/software/scm/git/git-2.35.3.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="4">
<li><strong>解压安装包</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">tar -xzvf git-2.35.3.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="5">
<li><p><strong>进入安装包</strong></p>
</li>
<li><p><strong>编译安装</strong></p>
</li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">make prefix</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/git all</span>
<span class="token key attr-name">make prefix</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/git install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<ol start="7">
<li><strong>进入目录下，配置环境变量</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">vim /etc/profile 
添加命令行
<span class="token key attr-name">export PATH</span><span class="token punctuation">=</span><span class="token value attr-value">$PATH:/usr/local/git/bin</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<ol start="8">
<li><strong>退出文件，是文件生效</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="9">
<li><strong>查看版本</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">git  --version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="10">
<li><strong>查看git位置</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">which git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>



<h2 id="4-7安装Jenkins"><a href="#4-7安装Jenkins" class="headerlink" title="4.7安装Jenkins"></a>4.7安装Jenkins</h2><ol>
<li><strong>在war包目录下运行命令运行war包，后台启动war包，并不产生日志</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">nohup java -jar jenkins.war >/dev/null 2>&amp;1 &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="2">
<li><strong>访问主机IP+8080端口，根据提示获得管理员登录密码</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028215546210.png" srcset="/img/loading.gif" lazyload alt="image-20221028215546210"></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">vim /root/.jenkins/secrets/initialAdminPassword<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>



<ol start="3">
<li><strong>根据提示安装推荐的插件</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012201014643.png" srcset="/img/loading.gif" lazyload alt="image-20221012201014643"></p>
<p><strong>开始安装插件</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012201125712.png" srcset="/img/loading.gif" lazyload alt="image-20221012201125712"></p>
<p><strong>创建管理员用户</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012202059586.png" srcset="/img/loading.gif" lazyload alt="image-20221012202059586"></p>
<p><strong>登录成功</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012202139844.png" srcset="/img/loading.gif" lazyload alt="image-20221012202139844"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20230605204123873.png" srcset="/img/loading.gif" lazyload alt="image-20230605204123873"></p>
<h1 id="5-凭证"><a href="#5-凭证" class="headerlink" title="5.凭证"></a>5.凭证</h1><h2 id="5-1凭证的概念"><a href="#5-1凭证的概念" class="headerlink" title="5.1凭证的概念"></a>5.1凭证的概念</h2><p>凭据可以用来存储需要密文保护的数据库密码、Gitlab密码信息、Docker私有仓库密码等，以便Jenkins可以和这些第三方的应用进行交互。</p>
<h2 id="5-2安装Credentials-Binding插件"><a href="#5-2安装Credentials-Binding插件" class="headerlink" title="5.2安装Credentials Binding插件"></a>5.2安装Credentials Binding插件</h2><p>​		这个插件推荐的安装插件中有</p>
<p>​	要在Jenkins使用凭证管理功能，需要安装Credentials Binding插件</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028225150747.png" srcset="/img/loading.gif" lazyload alt="image-20221028225150747"></p>
<h2 id="5-3添加全局凭证"><a href="#5-3添加全局凭证" class="headerlink" title="5.3添加全局凭证"></a>5.3添加全局凭证</h2><p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028225624853.png" srcset="/img/loading.gif" lazyload alt="image-20221028225624853"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028225646981.png" srcset="/img/loading.gif" lazyload alt="image-20221028225646981"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028225808792.png" srcset="/img/loading.gif" lazyload alt="image-20221028225808792"></p>
<h2 id="5-4普通用户密码凭证"><a href="#5-4普通用户密码凭证" class="headerlink" title="5.4普通用户密码凭证"></a>5.4普通用户密码凭证</h2><p><strong>输入GitHub用户名和密码</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028230407227.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028230425164.png" srcset="/img/loading.gif" lazyload alt="image-20221028230425164"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028234330597.png" srcset="/img/loading.gif" lazyload alt="image-20221028234330597"></p>
<h2 id="5-5SSH密钥凭证"><a href="#5-5SSH密钥凭证" class="headerlink" title="5.5SSH密钥凭证"></a>5.5SSH密钥凭证</h2><p>SSH免密登录示意图：公钥私钥</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028230840376.png" srcset="/img/loading.gif" lazyload alt="image-20221028230840376"></p>
<ol>
<li><strong>在云服务器上or虚拟机上使用root用户生成公钥和私钥</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">ssh-keygen -t rsa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028231419321.png" srcset="/img/loading.gif" lazyload alt="image-20221028231419321"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028231633083.png" srcset="/img/loading.gif" lazyload alt="image-20221028231633083"></p>
<h2 id="5-6在GitHub中设置公钥"><a href="#5-6在GitHub中设置公钥" class="headerlink" title="5.6在GitHub中设置公钥"></a>5.6在GitHub中设置公钥</h2><ol>
<li><strong>复制公钥文件内容</strong></li>
</ol>
<p>​	<img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028231950098.png" srcset="/img/loading.gif" lazyload alt="image-20221028231950098"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028232154790.png" srcset="/img/loading.gif" lazyload alt="image-20221028232154790"></p>
<p>公钥生成成功：</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028232139791.png" srcset="/img/loading.gif" lazyload alt="image-20221028232139791"></p>
<h2 id="5-7在Jenkins中设置私钥"><a href="#5-7在Jenkins中设置私钥" class="headerlink" title="5.7在Jenkins中设置私钥"></a>5.7在Jenkins中设置私钥</h2><ol>
<li><strong>添加全局凭证，选择凭证方式为SSH</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028232855897.png" srcset="/img/loading.gif" lazyload alt="image-20221028232855897"></p>
<ol start="2">
<li><strong>查看私钥并复制</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028232954958.png" srcset="/img/loading.gif" lazyload alt="image-20221028232954958"></p>
<ol start="3">
<li><strong>添加凭证</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028233123963.png" srcset="/img/loading.gif" lazyload alt="image-20221028233123963"></p>
<ol start="4">
<li><strong>生成对应的SSH全局凭据</strong></li>
</ol>
<p>​			<strong><font color='red'>后面使用SSH方式连接远程仓库的时候会用到</font></strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102125948073.png" srcset="/img/loading.gif" lazyload alt="image-20221102125948073"></p>
<h1 id="6-安装相应插件并配置"><a href="#6-安装相应插件并配置" class="headerlink" title="6.安装相应插件并配置"></a>6.安装相应插件并配置</h1><h2 id="6-2安装maven插件"><a href="#6-2安装maven插件" class="headerlink" title="6.2安装maven插件"></a>6.2安装maven插件</h2><p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012202609183.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012202743967.png" srcset="/img/loading.gif" lazyload></p>
<ol>
<li><strong>配置Maven和Git</strong></li>
</ol>
<p>​                                         <img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102133927304.png" srcset="/img/loading.gif" lazyload>		</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012210432350.png" srcset="/img/loading.gif" lazyload></p>
<ol start="2">
<li><strong>git的位置：</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">which git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>



<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030113513538.png" srcset="/img/loading.gif" lazyload alt="image-20221030113513538"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030113521019.png" srcset="/img/loading.gif" lazyload alt="image-20221030113521019"></p>
<h2 id="6-2安装Publish-Over-SSH插件"><a href="#6-2安装Publish-Over-SSH插件" class="headerlink" title="6.2安装Publish Over SSH插件"></a>6.2安装Publish Over SSH插件</h2><p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013094709516.png" srcset="/img/loading.gif" lazyload alt="image-20221013094709516"></p>
<ol>
<li><strong>配置Publish Over SSH</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102134009983.png" srcset="/img/loading.gif" lazyload alt="image-20221102134009983"></p>
<p>​			点击系统配置，找到Publish Over SSH进行配置</p>
<p>​			&#x3D;&#x3D;在这里指定过目标远程目录后，在配置项目的Post Steps的设置中就不需要再设置&#x3D;&#x3D;</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102131219560.png" srcset="/img/loading.gif" lazyload alt="image-20221102131219560"></p>
<ol start="2">
<li><strong>点击高级，设置远程服务器登录密码</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102131440624.png" srcset="/img/loading.gif" lazyload alt="image-20221102131440624"></p>
<p><strong>测试连接远程主机成功</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013100815480.png" srcset="/img/loading.gif" lazyload alt="image-20221013100815480"></p>
<h2 id="6-3安装Gitee插件"><a href="#6-3安装Gitee插件" class="headerlink" title="6.3安装Gitee插件"></a>6.3安装Gitee插件</h2><ol>
<li><strong>安装插件</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102153001630.png" srcset="/img/loading.gif" lazyload alt="image-20221102153001630"></p>
<ol start="2">
<li><strong>在Gitee中生成token</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102154523881.png" srcset="/img/loading.gif" lazyload></p>
<ol start="3">
<li><strong>添加全局凭据</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102154440405.png" srcset="/img/loading.gif" lazyload></p>
<ol start="4">
<li><strong>测试连接</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102154749057.png" srcset="/img/loading.gif" lazyload></p>
<p>5. </p>
<h1 id="7-Web-Hooks自动构建"><a href="#7-Web-Hooks自动构建" class="headerlink" title="7.Web Hooks自动构建"></a>7.Web Hooks自动构建</h1><h2 id="7-1GitLab钩子自动构建"><a href="#7-1GitLab钩子自动构建" class="headerlink" title="7.1GitLab钩子自动构建"></a>7.1GitLab钩子自动构建</h2><ol>
<li><strong>在Maven项目中创建触发器</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013160851016.png" srcset="/img/loading.gif" lazyload alt="image-20221013160851016"></p>
<ol start="2">
<li><p><strong>在浏览器输入<code>ip+jenkins端口+/job/first-project/build?token=身份验证令牌</code></strong></p>
<p><strong>项目自动构建</strong></p>
</li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013161158662.png" srcset="/img/loading.gif" lazyload alt="image-20221013161158662"></p>
<ol start="3">
<li><strong>下载插件，用于匿名访问构建，防止不在一个Session中而无法请求</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013162136141.png" srcset="/img/loading.gif" lazyload alt="image-20221013162136141"></p>
<ol start="4">
<li><strong>使用postman进行测试</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013162847133.png" srcset="/img/loading.gif" lazyload alt="image-20221013162847133"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013163753188.png" srcset="/img/loading.gif" lazyload alt="image-20221013163753188"></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">http://192.168.26.135:8080/buildByToken/build?job</span><span class="token punctuation">=</span><span class="token value attr-value">first-project&amp;token=root</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>



<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013163739645.png" srcset="/img/loading.gif" lazyload alt="image-20221013163739645"></p>
<ol start="5">
<li><strong>在GitLab中设置 Web hooks (网络钩子)</strong></li>
</ol>
<p>​			即在进行推送和合并请求时就自动构建</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013164356773.png" srcset="/img/loading.gif" lazyload alt="image-20221013164356773"></p>
<p>​		<font color='red'>但是提交Web hooks提示不能够向本地发送网络请求</font></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013164237124.png" srcset="/img/loading.gif" lazyload alt="image-20221013164237124"></p>
<p>​		解决方案：</p>
<p>​			以管理员身份进行登录</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013164638214.png" srcset="/img/loading.gif" lazyload alt="image-20221013164638214"></p>
<ol start="6">
<li><strong>设置出站请求</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013164746128.png" srcset="/img/loading.gif" lazyload alt="image-20221013164746128"></p>
<ol start="7">
<li><strong>保存完成</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013165122837.png" srcset="/img/loading.gif" lazyload alt="image-20221013165122837"></p>
<ol start="8">
<li><strong>idea推送测试</strong></li>
</ol>
<p>​			<strong>首先创建合并请求</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013170040246.png" srcset="/img/loading.gif" lazyload alt="image-20221013170040246"></p>
<p>​			<strong>再批准构建</strong></p>
<p>​			<font color='red'>但这样会产生两次自动构建，因为创建合并请求和同意合并请求的时候都会触发自动构建</font></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013171024388.png" srcset="/img/loading.gif" lazyload alt="image-20221013171024388"></p>
<ol start="9">
<li><strong>查看项目更新情况</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013171311026.png" srcset="/img/loading.gif" lazyload alt="image-20221013171311026"></p>
<h2 id="7-2GitHub钩子自动构建"><a href="#7-2GitHub钩子自动构建" class="headerlink" title="7.2GitHub钩子自动构建"></a>7.2GitHub钩子自动构建</h2><h3 id="7-2-1GitHub自动构建原理"><a href="#7-2-1GitHub自动构建原理" class="headerlink" title="7.2.1GitHub自动构建原理"></a>7.2.1GitHub自动构建原理</h3><ul>
<li>本地代码push到Github</li>
<li>webhook检测到Github的push事件</li>
<li>触发Jenkins进行一次build</li>
<li>自动化部署完成</li>
</ul>
<h3 id="7-2-2GitHub生成Token"><a href="#7-2-2GitHub生成Token" class="headerlink" title="7.2.2GitHub生成Token"></a>7.2.2GitHub生成Token</h3><p><font color='red'><strong>若已经生成过Token这一步可以省略，直接到7.2.3</strong></font></p>
<ol>
<li><strong>登录到Github –&gt;Settings –&gt; Developer settings –&gt; Personal access tokens –&gt; Token(classic) -&gt;  Generate new token</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030152641796.png" srcset="/img/loading.gif" lazyload alt="image-20221030152641796"></p>
<ol start="2">
<li><strong>设置Token</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030152828277.png" srcset="/img/loading.gif" lazyload alt="image-20221030152828277"></p>
<ol start="3">
<li><strong><font color='red'>记得保存Token，因为Token只会生成一次</font></strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030152956422.png" srcset="/img/loading.gif" lazyload alt="image-20221030152956422"></p>
<h3 id="7-2-3设置GitHub-Server"><a href="#7-2-3设置GitHub-Server" class="headerlink" title="7.2.3设置GitHub Server"></a>7.2.3设置GitHub Server</h3><ol>
<li><strong>添加GitHub服务器，并设置凭据（<font color='red'>若已经添加过了这一步可以省略</font>）</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030155250157.png" srcset="/img/loading.gif" lazyload alt="image-20221030155250157"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030155026105.png" srcset="/img/loading.gif" lazyload alt="image-20221030155026105"></p>
<ol start="2">
<li><strong>点击管理Hook</strong></li>
</ol>
<p>	</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030155046343.png" srcset="/img/loading.gif" lazyload alt="image-20221030155046343"></p>
<ol start="3">
<li><strong>测试连接</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102142156054.png" srcset="/img/loading.gif" lazyload alt="image-20221102142156054"></p>
<h3 id="7-2-4设置项目的“构建触发器选项”"><a href="#7-2-4设置项目的“构建触发器选项”" class="headerlink" title="7.2.4设置项目的“构建触发器选项”"></a>7.2.4设置项目的“构建触发器选项”</h3><p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030155634824.png" srcset="/img/loading.gif" lazyload alt="image-20221030155634824"></p>
<p>&#x3D;&#x3D;当Jenkins收到GitHub推送钩子时，GitHub插件会检查该钩子是否来自与该作业的SCM&#x2F;Git部分中定义的Git存储库匹配的GitHub存储库。如果它们匹配并且启用了此选项，GitHub插件将在GITScm上触发一次性轮询。当GITScm轮询GitHub时，它发现有变化，并启动构建。&#x3D;&#x3D;</p>
<p><font color='orange'><strong>设置过源码管理（连接到仓库）和构建触发器（设置WebHook触发器）后，在项目的Setting中会自动生成WebHook</strong></font></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103132558985.png" srcset="/img/loading.gif" lazyload alt="image-20221103132558985"></p>
<p>点击编辑查看WebHook：**<font color='red'>默认为推送事件触发WebHook</font>**</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103132615007.png" srcset="/img/loading.gif" lazyload alt="image-20221103132615007"></p>
<h1 id="8-Jenkins部署后端项目"><a href="#8-Jenkins部署后端项目" class="headerlink" title="8.Jenkins部署后端项目"></a>8.Jenkins部署后端项目</h1><h2 id="8-1新建Maven项目"><a href="#8-1新建Maven项目" class="headerlink" title="8.1新建Maven项目"></a>8.1新建Maven项目</h2><p><strong>新建maven项目</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012202945237.png" srcset="/img/loading.gif" lazyload alt="image-20221012202945237"></p>
<h2 id="8-2源码管理"><a href="#8-2源码管理" class="headerlink" title="8.2源码管理"></a>8.2源码管理</h2><ol>
<li><strong>点击源码管理，设置远程仓库地址，这里使用SSH的方式拉取远程仓库，因为先前已经配置过了SSH全局凭证</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103131129164.png" srcset="/img/loading.gif" lazyload alt="image-20221103131129164"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103130832440.png" srcset="/img/loading.gif" lazyload alt="image-20221103130832440"></p>
<ol start="2">
<li>**<font color='red'>注意：</font>**如果是初次连接会报错，连接不上，报错信息如下：</li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102163239012.png" srcset="/img/loading.gif" lazyload></p>
<p>xxxxxxxxxx7 1public static void main(String[] args) {2    List<Author> authors &#x3D; getAuthors();3    authors.parallelStream()4            .map(author -&gt; author.getAge())5            .mapToInt(age -&gt; age + 10)6            .forEach(name -&gt; System.out.println(name));7}java</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">git clone SSH地址<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103101012540.png" srcset="/img/loading.gif" lazyload alt="image-20221103101012540"></p>
<p>&#x3D;&#x3D;再删除拉取成功的项目文件，回到Jenkins配置中查看，报错信息消失。&#x3D;&#x3D;</p>
<ol start="4">
<li><strong>指定主分支</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012205126993.png" srcset="/img/loading.gif" lazyload alt="image-20221012205126993"></p>
<h2 id="8-4构建触发器"><a href="#8-4构建触发器" class="headerlink" title="8.4构建触发器"></a>8.4构建触发器</h2><p>由于之前已经设置过了WebHook，所以这一步直接选择，若未设置GitHub Server，请移步7.2章节配置GitHub的WebHooks</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030155634824.png" srcset="/img/loading.gif" lazyload alt="image-20221030155634824"></p>
<h2 id="8-5Pre-Steps"><a href="#8-5Pre-Steps" class="headerlink" title="8.5Pre Steps"></a>8.5Pre Steps</h2><p>为了解决每次在Jenkins中多次启动同一项目面对端口被占用的情况，<font color='red'>在自动部署前应该清理先前已经传过去的jar包并杀死已经运行的jar包服务</font></p>
<ol>
<li><strong>创建脚本文件</strong></li>
<li><strong>授予脚本文件执行权限</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">chomd 777 文件名<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<ol start="3">
<li><strong>编写脚本</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment">#!bin/bash</span>

<span class="token comment"># 删除项目jar</span>
rm -rf /root/jarpackage/vector-admin.jar
if [ -z $1 ];
        then
                echo "The args cannot be empty"
        else
                <span class="token key attr-name">appname</span><span class="token punctuation">=</span><span class="token value attr-value">$1</span>
fi
<span class="token comment"># 执行脚本传入的参数是项目名称  ./resetJar.sh xxxx项目名</span>
echo "arg:$1"

<span class="token comment"># 过滤出正在执行的jar程序的pid</span>
<span class="token key attr-name">pid</span><span class="token punctuation">=</span><span class="token value attr-value">`ps -ef | grep $1 | grep 'java -jar' | awk '&#123;printf $2&#125;'`</span>
echo $pid
<span class="token comment"># 如果pid为空,不执行杀进程</span>
if [ -z $pid ];
        then
                echo "$appname not started!"
        else
                kill -9 $pid
                echo "$appname stop success!"
fi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102140706369.png" srcset="/img/loading.gif" lazyload></p>
<p><strong><font color='red'>执行脚本命令前需要刷新配置</font></strong></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment">#刷新配置</span>
source /etc/profile
<span class="token comment">#防止Jenkins杀死脚本进程</span>
<span class="token key attr-name">BUILD_ID</span><span class="token punctuation">=</span><span class="token value attr-value">dontKillMe</span>
<span class="token comment">#执行脚本，删除jar包，杀死进程</span>
sh /root/jarpackage/vector-start.sh vector-admin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>



<h2 id="8-6Build"><a href="#8-6Build" class="headerlink" title="8.6Build"></a>8.6Build</h2><p><strong>指定pom文件</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221012210744605.png" srcset="/img/loading.gif" lazyload alt="image-20221012210744605"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221028154003244.png" srcset="/img/loading.gif" lazyload alt="image-20221028154003244"></p>
<h2 id="8-7Post-Steps"><a href="#8-7Post-Steps" class="headerlink" title="8.7Post Steps"></a>8.7Post Steps</h2><p><strong>进行以下操作：</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013101100219.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221030113903846.png" srcset="/img/loading.gif" lazyload></p>
<p>​			<strong><font color='red'>后续配置时出现的问题：</font></strong></p>
<p>​			<font color='scarlet'>拉取的jar包必须存在，否则上传的文件为0</font></p>
<p>​			<font color='red'>执行命令前刷新配置</font></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># 刷新配置</span>
source /etc/profile
<span class="token comment">#防止Jenkins杀死脚本进程</span>
<span class="token key attr-name">BUILD_ID</span><span class="token punctuation">=</span><span class="token value attr-value">dontKillMe</span>
<span class="token comment"># 运行jar包</span>
nohup java -jar /root/jarpackage/vector-admin.jar > vector-admin.log 2>&amp;1 &amp;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>





<h1 id="9-Jenkins部署前端项目（Vue）"><a href="#9-Jenkins部署前端项目（Vue）" class="headerlink" title="9.Jenkins部署前端项目（Vue）"></a>9.Jenkins部署前端项目（Vue）</h1><h2 id="9-1安装Node-js"><a href="#9-1安装Node-js" class="headerlink" title="9.1安装Node.js"></a>9.1安装Node.js</h2><p><a target="_blank" rel="noopener" href="http://nodejs.cn/download/">Node.js 中文网 (nodejs.cn)</a></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102143812421.png" srcset="/img/loading.gif" lazyload alt="image-20221102143812421"></p>
<ol>
<li><strong>下载安装包并传输到服务器的指定目录下：</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102144720013.png" srcset="/img/loading.gif" lazyload alt="image-20221102144720013"></p>
<ol start="2">
<li><strong>解压安装包</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">tar -xvf node-v16.18.0-linux-x64.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102144851922.png" srcset="/img/loading.gif" lazyload alt="image-20221102144851922"></p>
<ol start="3">
<li><strong>创建软连接</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">ln -s /root/node/node-v16.18.0-linux-x64/bin/node /usr/local/bin/
ln -s /root/node/node-v16.18.0-linux-x64/bin/npm /usr/local/bin/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<ol start="4">
<li><strong>检测在全局下能否查看node版本</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">node -v<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>​		<img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102145420364.png" srcset="/img/loading.gif" lazyload alt="image-20221102145420364"></p>
<ol start="5">
<li><strong>配置环境变量</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment"># 打开配置文件</span>
$ vim /etc/profile
 
<span class="token comment"># 添加配置</span>
<span class="token key attr-name">export NODE_HOME</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/node</span>
<span class="token key attr-name">export PATH</span><span class="token punctuation">=</span><span class="token value attr-value">$NODE_HOME/bin:$PATH</span>
 
<span class="token comment"># 重新加载profile文件</span>
$ source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<h2 id="9-2Jenkins配置Node-js"><a href="#9-2Jenkins配置Node-js" class="headerlink" title="9.2Jenkins配置Node.js"></a>9.2Jenkins配置Node.js</h2><ol>
<li><strong>安装Node.js插件</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102145836381.png" srcset="/img/loading.gif" lazyload></p>
<ol start="2">
<li><strong>全局配置Node.js</strong></li>
</ol>
<p>​		首先查看node的安装目录：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">which node<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102150825841.png" srcset="/img/loading.gif" lazyload alt="image-20221102150825841"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102150733464.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="9-3创建新项目"><a href="#9-3创建新项目" class="headerlink" title="9.3创建新项目"></a>9.3创建新项目</h2><p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102151345564.png" srcset="/img/loading.gif" lazyload alt="image-20221102151345564"></p>
<h2 id="9-4设置公钥和私钥"><a href="#9-4设置公钥和私钥" class="headerlink" title="9.4设置公钥和私钥"></a>9.4设置公钥和私钥</h2><h3 id="9-4-1在Gitee中设置公钥"><a href="#9-4-1在Gitee中设置公钥" class="headerlink" title="9.4.1在Gitee中设置公钥"></a>9.4.1在Gitee中设置公钥</h3><ol>
<li><strong>在搭建Jenkins的服务器中获取到公钥</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102152027583.png" srcset="/img/loading.gif" lazyload alt="image-20221102152027583"></p>
<ol start="2">
<li><strong>公钥设置成功</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102152620957.png" srcset="/img/loading.gif" lazyload alt="image-20221102152620957"></p>
<h3 id="9-4-2在Jenkisn中设置私钥-全局凭证"><a href="#9-4-2在Jenkisn中设置私钥-全局凭证" class="headerlink" title="9.4.2在Jenkisn中设置私钥-全局凭证"></a>9.4.2在Jenkisn中设置私钥-全局凭证</h3><p><strong><font color='red'>如果这一步已经做过请忽略</font></strong></p>
<ol>
<li><strong>点击管理凭证</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102162015907.png" srcset="/img/loading.gif" lazyload alt="image-20221102162015907"></p>
<ol start="2">
<li><strong>点击添加凭据</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102162057925.png" srcset="/img/loading.gif" lazyload alt="image-20221102162057925"></p>
<ol start="3">
<li><strong>选择SSH类型，填写私钥</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102162142536.png" srcset="/img/loading.gif" lazyload alt="image-20221102162142536"></p>
<h2 id="9-5源码管理"><a href="#9-5源码管理" class="headerlink" title="9.5源码管理"></a>9.5源码管理</h2><ol>
<li><p><strong>按照SSH连接远程库</strong></p>
<p>**<font color='red'>注意：</font>**如果是初次连接会报错，连接不上，报错信息如下：</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102163239012.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ol>
<p>​	&#x3D;&#x3D;<strong>第一次必须要在本机克隆拉取对应仓库</strong>&#x3D;&#x3D;，由于本人技术能力有限，目前不知此原因是为何。操作如下：</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">git clone SSH地址<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103101012540.png" srcset="/img/loading.gif" lazyload alt="image-20221103101012540"></p>
<p>&#x3D;&#x3D;再删除拉取成功的项目文件，回到Jenkins配置中查看，报错信息消失。&#x3D;&#x3D;</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103130237909.png" srcset="/img/loading.gif" lazyload alt="image-20221103130237909"></p>
<h2 id="9-6构建触发器"><a href="#9-6构建触发器" class="headerlink" title="9.6构建触发器"></a>9.6构建触发器</h2><ol>
<li><strong>选择Gitee webhook构建触发</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102163024214.png" srcset="/img/loading.gif" lazyload></p>
<ol start="2">
<li><p><strong>根据提示，在Gitee对应仓库的管理界面找到WebHooks选项，添加WebHooks，可以不设置密码</strong></p>
<p>​</p>
</li>
</ol>
<p>	</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102164022604.png" srcset="/img/loading.gif" lazyload></p>
<p>​	<img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102164113696.png" srcset="/img/loading.gif" lazyload alt="image-20221102164113696"></p>
<h2 id="9-7添加SSH-Server"><a href="#9-7添加SSH-Server" class="headerlink" title="9.7添加SSH Server"></a>9.7添加SSH Server</h2><ol>
<li><p><strong>在系统配置中找到Public Over SSH，新增SSH Server，这个SSH Server是当前端项目打包好后，发送到的目标服务器。这里的目标主机目录就是发送到文件的位置。</strong></p>
<p>​		目标目录说明：由于是Vue项目，所以之后将打包好的Vue项目直接放在nginx下的html目录中。&#x3D;&#x3D;<strong>&#x2F;usr&#x2F;local&#x2F;nginx就是nginx的默认安装目录</strong>&#x3D;&#x3D;。</p>
</li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103110319858.png" srcset="/img/loading.gif" lazyload alt="image-20221103110319858"></p>
<p><strong>测试连接成功：</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221102165925807.png" srcset="/img/loading.gif" lazyload alt="image-20221102165925807"></p>
<h2 id="9-8Build-Steps（构建）"><a href="#9-8Build-Steps（构建）" class="headerlink" title="9.8Build Steps（构建）"></a>9.8Build Steps（构建）</h2><ol>
<li><strong>Build Steps是构建操作，<font color='red'>它的任务就是将拉取到的项目文件见打包成dist文件夹并压缩</font>（<font color='skyblue'>Jenkins不支持发送文件夹，只支持发送文件</font>）。选择增加构建步骤，执行shell命令</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103101534443.png" srcset="/img/loading.gif" lazyload alt="image-20221103101534443"></p>
<ol start="2">
<li><strong>将以下命令写入shell命令行</strong></li>
</ol>
<p>命令依次是：</p>
<ul>
<li>&#x3D;&#x3D;清除缓存&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;以绝对路径的方式进入到从远程仓库拉取到的Vue项目的根目录下（<strong>Jenkins默认的拉取目录路径是&#x2F;root&#x2F;.jenkins&#x2F;workspace</strong>）&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;安装package.json文件中的依赖包到并且生成node_modules文件夹&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;打包成dist文件夹&#x3D;&#x3D;</li>
<li>&#x3D;&#x3D;将dist文件夹压缩成dist.tar.gz文件&#x3D;&#x3D;</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">npm cache clean -f
cd /root/.jenkins/workspace/vector-front/
npm install
npm run build<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103115623014.png" srcset="/img/loading.gif" lazyload alt="image-20221103115623014"></p>
<h2 id="9-9安装nginx"><a href="#9-9安装nginx" class="headerlink" title="9.9安装nginx"></a>9.9安装nginx</h2><p>Nginx百度云网盘地址：</p>
<p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hPSRTHlOb5i5RLUhQjDY6w?pwd=xha8">https://pan.baidu.com/s/1hPSRTHlOb5i5RLUhQjDY6w?pwd=xha8</a><br>         提取码：xha8</p>
<ol>
<li><strong>将下载好的Nginx安装包发送到服务器中（任意目录），并解压</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">tar -xzvf nginx-1.18.0.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>



<ol start="2">
<li><strong>进入到nginx-1.18.0目录下，并执行以下命令</strong></li>
</ol>
<p>配置</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">./configure<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>编译安装</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">make &amp;&amp; make install<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p>安装完成</p>
<p><strong><font color='red'>可以将压缩包和解压后的文件都删除</font></strong></p>
<ol start="3">
<li><strong>启动Nginx服务</strong></li>
</ol>
<p>​		进入到以下目录并执行.&#x2F;nginx命令启动Nginx服务</p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">cd /usr/local/nginx/sbin/
./nginx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20220918110812754.png" srcset="/img/loading.gif" lazyload alt="image-20220918110812754"></p>
<p>​		在本地输入云服务器公网ip，出现以下界面就表示Nginx安装成功。</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103105927391.png" srcset="/img/loading.gif" lazyload alt="image-20221103105927391"></p>
<h2 id="9-10构建后操作"><a href="#9-10构建后操作" class="headerlink" title="9.10构建后操作"></a>9.10构建后操作</h2><ol>
<li><p><strong>构建后的任务就是将刚刚压缩好的dist.tar.gz发送到远程目录，并执行脚本文件</strong>。</p>
</li>
<li><p><strong>在目标主机上创建”.sh脚本文件”，用于将刚刚发送到远程目录的压缩包进行解压</strong></p>
</li>
</ol>
<p>​		命令依次是：</p>
<ul>
<li>以绝对路径的方式进入到&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;html目录下（<font color='cornflowerblue'>此目录就是存放Vue打包成的dist文件夹压缩包的位置</font>）</li>
<li>解压安装包</li>
<li>以绝对路径的方式删除压缩包</li>
</ul>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">cd /usr/local/nginx/html
tar -xzvf dist.tar.gz
rm -rf /usr/local/nginx/html/dist.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></figure>

<ol start="3">
<li><strong>配置SSH Server，选择发送到的目标主机，将压缩包发送到目标目录，我这里vector-front.sh脚本文件就在&#x2F;root目录下，所以先进入&#x2F;root目录下再运行脚本命令。</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103102848818.png" srcset="/img/loading.gif" lazyload></p>
<ol start="4">
<li><strong>进入html目录下，查看发送过去的dist文件夹</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103120934447.png" srcset="/img/loading.gif" lazyload alt="image-20221103120934447"></p>
<h2 id="9-11修改nginx-conf配置文件"><a href="#9-11修改nginx-conf配置文件" class="headerlink" title="9.11修改nginx.conf配置文件"></a>9.11修改nginx.conf配置文件</h2><ol>
<li><strong>进入&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf目录下，编辑nginx.conf文件</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">cd /usr/local/nginx/conf
vim nginx.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></figure>

<p>​		<font color='red'>如果有多个Vue项目，就复制server内容，再写另一个server</font></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103121228342.png" srcset="/img/loading.gif" lazyload alt="image-20221103121228342"></p>
<h2 id="9-12测试"><a href="#9-12测试" class="headerlink" title="9.12测试"></a>9.12测试</h2><ol>
<li><p><strong>输入服务器ip+监听端口</strong></p>
</li>
<li><p><strong>测试成功</strong></p>
</li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221103121440936.png" srcset="/img/loading.gif" lazyload alt="image-20221103121440936"></p>
<h1 id="9-构建触发器的方式"><a href="#9-构建触发器的方式" class="headerlink" title="9.构建触发器的方式"></a>9.构建触发器的方式</h1><ul>
<li>&#x3D;&#x3D;快照依赖构建&#x2F;Build whenever a SNAPSHOT dependency is built&#x3D;&#x3D;<ul>
<li>当依赖的快照被构建时执行本job</li>
</ul>
</li>
<li>&#x3D;&#x3D;触发远程构建 (例如,使用脚本)&#x3D;&#x3D;<ul>
<li>远程调用本job的restapi时执行本job</li>
</ul>
</li>
<li>&#x3D;&#x3D;job依赖构建&#x2F;Build after other projects are built&#x3D;&#x3D;<ul>
<li>当依赖的job被构建时执行本job</li>
</ul>
</li>
<li>&#x3D;&#x3D;定时构建&#x2F;Build periodically&#x3D;&#x3D;<ul>
<li>使用cron表达式定时构建本job</li>
</ul>
</li>
<li>&#x3D;&#x3D;向GitHub提交代码时触发Jenkins自动构建&#x2F;GitHub hook trigger for GITScm polling&#x3D;&#x3D;<ul>
<li>Github-WebHook触发时构建本job</li>
</ul>
</li>
<li>&#x3D;&#x3D;定期检查代码变更&#x2F;Poll SCM&#x3D;&#x3D;<ul>
<li>使用cron表达式定时检查代码变更，变更后构建本job</li>
</ul>
</li>
</ul>
<h1 id="10-Jenkins-cron表达式-定时构建触发器"><a href="#10-Jenkins-cron表达式-定时构建触发器" class="headerlink" title="10.Jenkins cron表达式(定时构建触发器)"></a>10.Jenkins cron表达式(定时构建触发器)</h1><p>cron表达式模拟器：<a target="_blank" rel="noopener" href="https://crontab.guru/">Crontab.guru - The cron schedule expression editor</a></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013172851678.png" srcset="/img/loading.gif" lazyload alt="image-20221013172851678"></p>
<p>样例</p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013173417092.png" srcset="/img/loading.gif" lazyload alt="image-20221013173417092"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013173525932.png" srcset="/img/loading.gif" lazyload alt="image-20221013173525932"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013173741254.png" srcset="/img/loading.gif" lazyload alt="image-20221013173741254"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013190648728.png" srcset="/img/loading.gif" lazyload alt="image-20221013190648728"></p>
<h1 id="11-容器化构建"><a href="#11-容器化构建" class="headerlink" title="11.容器化构建"></a>11.容器化构建</h1><h2 id="11-1将jar包打包成镜像"><a href="#11-1将jar包打包成镜像" class="headerlink" title="11.1将jar包打包成镜像"></a>11.1将jar包打包成镜像</h2><ol>
<li><strong>将jar包传到指定目录下</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013195404372.png" srcset="/img/loading.gif" lazyload alt="image-20221013195404372"></p>
<ol start="2">
<li><strong>编写Dockerfile文件</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment">#基础镜像使用java</span>
FROM openjdk:8u342-jdk
<span class="token comment"># 作者</span>
MAINTAINER xha
<span class="token comment"># VOLUME 指定临时文件目录为/tmp，在主机/var/lib/docker目录下创建了一个临时文件并链接到容器的/tmp</span>
VOLUME /tmp
<span class="token comment"># 将jar包添加到容器中并更名</span>
ADD docker_test-0.0.1-SNAPSHOT.jar dockertest.jar
<span class="token comment"># 运行jar包</span>
RUN bash -c 'touch /dockertest.jar'
ENTRYPOINT ["java","-jar","/dockertest.jar"]
<span class="token comment">#暴露8090端口作为微服务</span>
EXPOSE 8090<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure>

<ol start="3">
<li><strong>构建镜像</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">docker build -t 镜像名:镜像版本 .<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013202446373.png" srcset="/img/loading.gif" lazyload alt="image-20221013202446373"></p>
<ol start="4">
<li><strong>在8090端口运行jar包</strong></li>
</ol>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">docker run d -p 8090:8090 --name project1 jenkins_jar:1.0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></figure>

<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013203605470.png" srcset="/img/loading.gif" lazyload alt="image-20221013203605470"></p>
<h2 id="11-2自动化部署构建Docker镜像运行jar"><a href="#11-2自动化部署构建Docker镜像运行jar" class="headerlink" title="11.2自动化部署构建Docker镜像运行jar"></a>11.2自动化部署构建Docker镜像运行jar</h2><ol>
<li><strong>在IDE中编写Dockerfile</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013210140235.png" srcset="/img/loading.gif" lazyload alt="image-20221013210140235"></p>
<ol start="2">
<li><p><strong>推送到远程库</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013221440228.png" srcset="/img/loading.gif" lazyload alt="image-20221013221440228"></p>
</li>
<li><p><strong>拉取jar包</strong></p>
</li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013221332281.png" srcset="/img/loading.gif" lazyload alt="image-20221013221332281"></p>
<ol start="4">
<li><strong>拉取Dockerfile文件，并创建镜像，并根据镜像创建容器实例</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221013221421768.png" srcset="/img/loading.gif" lazyload alt="image-20221013221421768"></p>
<ol start="5">
<li><p><strong>编写shell脚本，删除文件、镜像和容器</strong></p>
<figure><div class="code-wrapper"><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment">#!/bin/bash</span>
<span class="token comment"># 删除历史数据</span>
rm -rf project

<span class="token comment">#删除镜像</span>
docker rmi -f jenkins_jar:1.0
<span class="token comment">#删除容器</span>
docker rm -f jenkins_container<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></figure></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221014120537131.png" srcset="/img/loading.gif" lazyload alt="image-20221014120537131"></p>
<ol start="6">
<li><strong>构建</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221014120807593.png" srcset="/img/loading.gif" lazyload alt="image-20221014120807593"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221014120818796.png" srcset="/img/loading.gif" lazyload alt="image-20221014120818796"></p>
<h1 id="12-jenkins集群-x2F-并发构建"><a href="#12-jenkins集群-x2F-并发构建" class="headerlink" title="12.jenkins集群&#x2F;并发构建"></a>12.jenkins集群&#x2F;并发构建</h1><p>&#x3D;&#x3D;集群化构建可以有效提升构建效率，尤其是团队项目比较多或是子项目比较多的时候，可以并发在多台机器上执行构建。&#x3D;&#x3D;</p>
<ol>
<li><p><strong>再创建两台虚拟机</strong></p>
</li>
<li><p><strong>点击系统管理，再点击节点管理</strong></p>
</li>
</ol>
<p>​				<strong>创建新节点</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221014130519202.png" srcset="/img/loading.gif" lazyload alt="image-20221014130519202"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221014125123706.png" srcset="/img/loading.gif" lazyload alt="image-20221014125123706"></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221014125430843.png" srcset="/img/loading.gif" lazyload alt="image-20221014125430843"></p>
<p><strong>配置视图，选择在必要时候并发构建</strong></p>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221014130048980.png" srcset="/img/loading.gif" lazyload alt="image-20221014130048980"></p>
<h1 id="13-流水线pipeline"><a href="#13-流水线pipeline" class="headerlink" title="13.流水线pipeline"></a>13.流水线pipeline</h1><p>&#x3D;&#x3D;流水线既能作为任务的本身，也能作为Jenkinsfile(类似于Dockerfile)&#x3D;&#x3D;</p>
<p>使用流水线可以让我们的任务从ui手动操作，转换为代码化，像docker的dockerfile一样，从shell命令到配置文件，更适合大型项目，可以让团队其他开发者同时参与进来，同时也可以编辑开发Jenkinswebui不能完成的更复杂的构建逻辑，作为开发者可读性也更好。</p>
<ol>
<li><strong>创建pipeline项目</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221014132910262.png" srcset="/img/loading.gif" lazyload alt="image-20221014132910262"></p>
<ol start="2">
<li><strong>查看控制台信息</strong></li>
</ol>
<p><img src="https://imagebed-xuhuaiang.oss-cn-shanghai.aliyuncs.com/typora/image-20221014133042125.png" srcset="/img/loading.gif" lazyload alt="image-20221014133042125"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Jenkins/" class="category-chain-item">Jenkins</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Jenkins/">#Jenkins</a>
      
        <a href="/tags/CI-CD/">#CI/CD</a>
      
        <a href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/">#自动化部署</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Jenkins</div>
      <div>https://xhablog.online/2022/09/05/Jenkins/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Xu huaiang</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年9月5日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/09/10/Git/" title="Git">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Git</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/08/30/Docker/" title="Docker">
                        <span class="hidden-mobile">Docker</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.8.0/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"65685887a536577e68ad","clientSecret":"da9f0f4e5301326ac35bb6141f0234e2a7561f4c","repo":"sunwebgo.github.io","owner":"sunwebgo","admin":["sunwebgo"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token"},
          {
            id: '1e844533f92e5f705023c9c077fa1283'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <span><svg t="1686650467734" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4406" width="13" height="13"><path d="M926.991 337.678c-22.571-53.364-54.877-101.283-96.021-142.426-41.143-41.143-89.062-73.449-142.426-96.02-55.266-23.375-113.953-35.228-174.434-35.228-60.48 0-119.168 11.852-174.433 35.228-53.364 22.571-101.283 54.877-142.426 96.02s-73.449 89.062-96.02 142.426c-23.375 55.265-35.228 113.953-35.228 174.433 0 60.48 11.852 119.168 35.228 174.434 22.571 53.364 54.877 101.283 96.02 142.426 41.143 41.144 89.062 73.449 142.426 96.021 55.265 23.375 113.953 35.228 174.433 35.228 60.48 0 119.168-11.853 174.434-35.228 53.364-22.571 101.283-54.877 142.426-96.021 41.144-41.143 73.449-89.062 96.021-142.426 23.375-55.266 35.228-113.953 35.228-174.434 0-60.48-11.853-119.168-35.228-174.433z m-412.88 558.541c-211.797 0-384.107-172.31-384.107-384.107 0-211.797 172.31-384.107 384.107-384.107 211.798 0 384.107 172.31 384.107 384.107 0.001 211.797-172.309 384.107-384.107 384.107z" p-id="4407"></path><path d="M514.111 290.829c51.918 0 102.431 18.428 142.233 51.889 13.528 11.375 33.715 9.626 45.086-3.902 11.373-13.527 9.626-33.713-3.902-45.086-51.316-43.142-116.456-66.901-183.417-66.901-76.201 0-147.842 29.675-201.725 83.557-53.883 53.883-83.558 125.523-83.558 201.725s29.675 147.843 83.558 201.726 125.523 83.558 201.725 83.558c66.961 0 132.1-23.76 183.417-66.901 13.528-11.372 15.275-31.559 3.902-45.086s-31.559-15.275-45.086-3.902c-39.803 33.462-90.315 51.89-142.233 51.89-122.015 0-221.282-99.268-221.282-221.283 0-122.017 99.267-221.284 221.282-221.284z" p-id="4408"></path></svg>2021 - 2023</span> <span>本站由</span> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <span>&</span> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <span>强力驱动</span> 
      <!--《添加网站运行时间 -->
<br/>

    <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
    <script>
      var now = new Date();

      function createtime() {
        //此处修改你的建站时间或者网站上线时间
        var grt = new Date('06/09/2023 8:00:00');
        now.setTime(now.getTime() + 250);
        days = (now - grt) / 1000 / 60 / 60 / 24;

        dnum = Math.floor(days);
        hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if (String(hnum).length == 1) {
          hnum = "0" + hnum;
        }
        minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if (String(mnum).length == 1) {
          mnum = "0" + mnum;
        }
        seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if (String(snum).length == 1) {
          snum = "0" + snum;
        }
        document.getElementById("timeDate").innerHTML = " 本站已破天荒的安全运行 " + dnum + " 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
      }
      setInterval("createtime()", 250);
    </script>

<!-- 添加网站运行时间》-->
<br/>
<span style="font-weight: initial">文章总字数2648k</span>

    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script  src="https://lib.baomitu.com/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js" ></script>

  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
